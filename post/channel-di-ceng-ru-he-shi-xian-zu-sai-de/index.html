<!doctype html>
<html amp lang="zh-Hans">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="
每日一问系列（一）

我们都知道，channel在缓冲区满或者无缓冲的时候，发送数据会阻塞，缓冲区空或无缓冲的时候，接受也会阻塞
那么这个阻塞，是怎么实现的呢？
之前我们只是粗略的讲解了channel的实现的结构体，这次我们详细的看看发送..." />
<link rel="preload" as="script" href="https://cdn.ampproject.org/v0.js">
<link rel="preconnect dns-prefetch" href="https://cdn.jsdelivr.net/" crossorigin>
<script async src="https://cdn.ampproject.org/v0.js"></script>
<title>Channel底层如何实现阻塞的 | Zer0kiriN</title>


  

    
        <style amp-custom>
            body {
                width: 100vw;
                display: flex;
                flex-direction: column;
                font-family: 'PT Serif',-apple-system-font,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif, serif;
                background: white;
            }
            *:focus{
                outline: none;
            }
            @font-face {
                font-family: 'iconfont';
                src: url('https://cdn.jsdelivr.net/gh/jiansing/gridea-theme-inlineamp/inlineamp/assets/media/fonts/iconfont.eot?20200105#iefix') format('embedded-opentype'),
                    url('https://cdn.jsdelivr.net/gh/jiansing/gridea-theme-inlineamp/inlineamp/assets/media/fonts/iconfont.woff2?20200105') format('woff2'),
                    url('https://cdn.jsdelivr.net/gh/jiansing/gridea-theme-inlineamp/inlineamp/assets/media/fonts/iconfont.woff?20200105') format('woff'),
                    url('https://cdn.jsdelivr.net/gh/jiansing/gridea-theme-inlineamp/inlineamp/assets/media/fonts/iconfont.ttf?20200105') format('truetype'),
                    url('https://cdn.jsdelivr.net/gh/jiansing/gridea-theme-inlineamp/inlineamp/assets/media/fonts/iconfont.svg?20200105#iconfont') format('svg');
            }
            @font-face {
              font-family: 'PT Serif';
              font-style: normal;
              font-weight: 400;
              font-display: swap;
              src: local('PT Serif'), local('PTSerif-Regular'), url('https://cdn.jsdelivr.net/gh/jiansing/gridea-theme-inlineamp/inlineamp/assets/media/fonts/ptserif.woff2') format('woff2');
              unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
            }
            .iconfont {
                font-family: "iconfont";
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }
            /* CSS reset */
            textarea,
            input[type="password"],
            input[type="text"],
            input[type="url"],
            input[type="email"],
            input[type="submit"]
            {
                -webkit-appearance: none;
                border-radius: 0;
            }
            header {
                width: 100vw;
                background: #000000;
                display: flex;
                justify-content: center;
            }
            .top-container {
                width: 71.4286vw;
                height: 100%;
            }
            .title-menus-area {
                display: flex;
                width: 100%;
                height: 5.8095vw;
                justify-content: space-between;
            }
            .blog-title {
                display: flex;
                font-size: 1.6667vw;
                font-weight: bold;
                color: white;
                margin-top: 1.2857vw;
                white-space: nowrap;
                text-decoration: none;
                line-height: 1.6667vw;
            }
            .tagline {
                display: flex;
                width: 100%;
                flex-direction: column;
                align-items: center;
            }
            .tagline-main {
                color: white;
                font-size: 2.9286vw;
                margin-bottom: 1.6667vw;
                line-height: 2.9286vw;
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            .tagline-main:after {
                content: '';
                display: flex;
                background: #F6F8FA;
                width: 4.7619vw;
                height: 0.2381vw;
                margin-top: 1.6667vw;
            }
            .tagline-sub {
                color: #8A8A8A;
                font-size: 0.9524vw;
                line-height: 1.6667vw;
                margin-bottom: 3.5119vw;
            }
            .tagline-sub a {
                text-decoration: none;
                color: unset;
            }
            .tagline-sub a:hover {
                color: #004578;
            }
            /* go top button */
            .scrolltop-wrap {
                box-sizing: border-box;
                position: absolute;
                top: 11.6667vw;
                right: -3.9048vw;
                bottom: 0;
            }
            .go-top {
                width: 2.9762vw;
                height: 2.9762vw;
                font-size: 1.1905vw;
                text-decoration: none;
                background: #004578;
                border-radius: 100%;
                color: white;
                justify-content: center;
                align-items: center;
                display: flex;
                cursor: pointer;
                
                position: fixed;
                position: -webkit-sticky;
                position: sticky;
                top: -5.9524vw;
                transform: translateY(100vh);
                overflow: hidden;
            }
            @media only screen and (max-width: 640px){
                .top-container {
                    width: 100%;
                }
                .title-menus-area {
                    padding-top: 4.6667vw;
                    height: auto;
                    position: relative;
                }
                .blog-title { 
                    margin-top: 0;
                    margin-left: 5.3333vw;
                    font-size: 3.7333vw;
                    line-height: 3.7333vw;
                }
                .tagline {
                    margin: 6vw auto 0 auto;
                    width:89.3333vw;
                }
                .tagline-main {
                    font-size: 5.0667vw;
                    line-height: 5.0667vw;
                    margin-bottom: 2vw;
                }
                .tagline-main:after {
                    width: 8.8vw;
                    height: 0.44vw;
                    margin-top: 3.0667vw;
                }
                .tagline-sub {
                    font-size: 2.9333vw;
                    line-height: 5.1333vw;
                }
                .scrolltop-wrap {
                    display: none;      
                }
            }/* top menu */
            .top-menus {
                display: flex;
                padding-right: 1.7619vw;
                padding-top: 1.5833vw;
                height: 0.9524vw;
            }
            .top-menus>nav>ul>li {
                display: flex;
                list-style: none;
                margin-left: 2.393vw;
                margin-bottom: 0.2976vw;
                position: relative;
                height: 1.9644vw;
            }
            .top-menus>nav>ul>li>a{
                color: white;
                font-size: 0.9524vw;
                line-height: 0.9524vw;
                text-decoration: none;
            }
            .top-menus .menu {
                display: flex;
                margin: 0;
                padding: 0;
                white-space: nowrap;
                list-style: none;
                justify-content: flex-end;
                flex-wrap: wrap;
            }
            /* sub menu */
            .top-menus>nav>ul>li.menu-item-has-children>a:after {
                font-family: "iconfont";
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                content: '\e62b';
                margin-left: 0.5952vw;
                font-size: 0.9524vw;
            }
            .top-menus>nav>ul>li:hover a {
                color: #004578;
            }
            .top-menus>nav>ul>li:hover>ul {
                opacity: 1;
                visibility: visible;
                transition: 0.2s all ease;
            }
            .top-menus>nav>ul>li>.sub-menu {
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
                margin-top:1.9345vw;
                display: flex;
                flex-direction: column;
                background: #2A2A2A;
                border: #4A4A4A 0.0595vw solid;
                padding-top: 0.4167vw;
                padding-bottom: 0.4167vw;
                padding-left: 1.2501vw;
                padding-right: 1.2501vw;
                z-index: 1;
                overflow:hidden;   
                opacity: 0;
                visibility: hidden;
                transition: 0.2s all ease; 
            }
            .top-menus>nav>ul>li>.sub-menu>li {
                list-style:none;
                border-bottom: #4A4A4A 0.0595vw solid;
            }
            .top-menus>nav>ul>li>.sub-menu>li:last-child {
                border-bottom: 0
            }
            .top-menus ul>li>.sub-menu>li>a {
                font-size: 0.8333vw;
                line-height: 0.8333vw;
                color: white;
                text-decoration: none;
                width: 100%;
                min-height: 2.4405vw;
                display: flex;
                align-items: center;
            }
            /* third level menu */
            .top-menus>nav>ul>li>.sub-menu>li ul {
                padding-left: 0.893vw;
            }
            .top-menus>nav>ul>li>.sub-menu>li>ul li {
                list-style:none;
            }
            .top-menus>nav>ul>li>.sub-menu>li ul li a{
                color: rgba(255,255,255,0.4);
                min-height: unset;
                margin-bottom: 0.6548vw;
            }
            .top-menus>nav>ul>li>.sub-menu>li ul li a:before {
                content: '-';
                margin-right: 0.2976vw;
            }
            .top-menus>nav>ul>li>.sub-menu>li a:hover {
                color: #004578;
            }
            #header-menu-button {
                display: none;
            }
            @media only screen and (max-width: 640px){
                /* expand menu */
                #header-menu-button + header .top-menus {
                    display: flex;
                    position: absolute;
                    width: 100%;
                    padding: 0;
                    height: auto;
                    top: 0;
                    z-index: 1;
                    pointer-events: none;
                }
                #header-menu-button:checked + header .top-menus {
                    pointer-events: auto;
                }
                #header-menu-button:checked + header .top-menus nav>ul{
                    padding-left: 4vw;
                    padding-right: 4vw;
                    opacity: 1;
                    visibility: visible;
                    padding-bottom: 16vw;
                }
                #header-menu-button + header .top-menus nav>ul {
                    min-height: 100vh;
                    position:fixed;
                    top: 0;
                    bottom: 0;
                    overflow: scroll;
                    flex-wrap: nowrap;
                    opacity: 0;
                    transition: 0.6s all ease;
                    visibility: hidden;
                    display: flex;
                    width: 100%;
                    flex-direction: column;
                    background: #000000;
                    justify-content: start;
                    padding-top: 0;
                    padding-bottom: 4.1333vw;
                    box-sizing: border-box;
                }
                #header-menu-button + header .top-menus nav>ul>li{
                    margin: 0;
                    height: auto;
                    padding-left: 1.3333vw;
                    padding-right: 1.3333vw;
                    border-bottom: 0.1333vw #4A4A4A solid;
                    flex-direction: column;
                    padding-top: 4.0667vw;
                    padding-bottom: 4.0667vw;
                }
                #header-menu-button + header .top-menus nav>ul>li:first-child>a {
                    padding-top: 0;
                }
                #header-menu-button + header .top-menus nav>ul>li:last-child {
                    border-bottom: none;
                }
                #header-menu-button + header .top-menus nav>ul>li>a {
                    font-size: 3.7333vw;
                    line-height: 3.7333vw;
                }
                .top-menus>nav>ul>li.menu-item-has-children>a:after {
                    display: none;
                }
                ul#menu-top-menu li {
                    display: inline-flex;
                    white-space: normal;
                }
                .top-menus>nav>ul>li>.sub-menu {
                    display: flex;
                    transform: none;
                    position: relative;
                    left: 0;
                    margin-top: 0;
                    margin-bottom: 4vw;
                    background: inherit;
                    border: none;
                    padding: 0;
                    padding-left: 3vw;
                    opacity: 1;
                    visibility: visible;
                }
                .top-menus>nav>ul>li:hover a {
                    color: white;
                }
                .top-menus>nav>ul li a:hover {
                    color: #004578;
                }
                .top-menus>nav>ul>li>.sub-menu>li {
                    border: none;
                    margin-top: 3.7067vw;
                    flex-direction: column;
                }
                .top-menus>nav>ul>li>.sub-menu>li>a:before {
                    content: '-';
                    margin-right: 0.8vw;
                    color: rgba(255,255,255,0.4);
                }
                .top-menus>nav>ul>li>.sub-menu>li ul {
                    padding-left: 3vw;
                }
                .top-menus>nav>ul>li>.sub-menu>li ul li a {
                    margin-bottom: 0;
                    margin-top: 3.7067vw;
                }
                .top-menus ul>li>.sub-menu>li>a {
                    font-size: 3.7333vw;
                    line-height: 3.7333vw;
                    color: rgba(255,255,255,0.4);
                }
                #header-menu-button{
                    display:flex;
                    margin: 0;
                    -webkit-appearance: none;
                    appearance: none;
                    line-height: 3.7333vw;
                    width: 4vw;
                    height: 4vw;
                    z-index: 2;
                    position: absolute;
                    right: 4vw;
                    top: 4vw;
                    border: none;
                    background: transparent;
                }
                /* hide for menu scroll */
                #header-menu-button:checked + header + main {
                    animation: mainhide 2s ease;
                    animation-fill-mode: forwards; 
                    -webkit-animation-fill-mode: forwards; 
                    overflow: hidden;
                }
                @keyframes mainhide {
                    from {
                        max-height: auto;
                    }
                    to {
                        overflow: hidden;
                        max-height: 0;
                    }
                }
                #header-menu-button:checked {
                    position: fixed;
                }
                #header-menu-button:checked:after{
                    display: flex;
                    content: '\e63c';
                    transform: scale(0.7);
                }
                #header-menu-button:after{
                    content: '';  
                    color: white;
                    font-family: "iconfont";
                    font-size: 5.3333vw;
                    -webkit-font-smoothing: antialiased;
                    -moz-osx-font-smoothing: grayscale;
                    content: '\e63e';
                }
            }            
            /* body content */
            main {
                width: 71.4286vw;
                display: flex;
                margin: 0 auto;
                justify-content: space-between;
                padding-top: 2.9762vw;
                position: relative;
            }
            .main-container {
                width: 48.2143vw;
            }
            .list-box {
                width: 100%;
                display: flex;
                flex-direction: column;
                margin-bottom: 2.9762vw;
            }
            .title-img {
                width: 48.2143vw;
                height: 17.8571vw;
                position: relative;
            }
            .title-img amp-img.contain img {
                object-fit: cover;
                object-position: top;
                transition: all .5s;
            }
            a.title-img:hover amp-img.contain img {
                object-fit: cover;
                transform: scale(1.08);
                -webkit-transform: scale(1.08);
                -moz-transform: scale(1.08);
            }
            .post-info {
                position: relative;
                padding-left: 1.7857vw;
                padding-top: 1.5119vw;
                padding-right: 1.7857vw;
                padding-bottom: 1.7857vw;
                width: 48.2143vw;
                border: 0.0595vw solid #E6E6E6;
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
            }
            .post-cate {
                font-size: 0.9524vw;
                line-height: 1.5476vw;
                color: #004578;
                text-decoration: none;
                margin-right: 0.9644vw;  
                display: flex;
                align-items: center;
            }
            .sticky-tag {
                display: flex;
                align-items: center;  
                color: #004578;
            }
            .post-cate:before,
            .sticky-tag:before {
                display: flex;
                content: '';
                width:0.0595vw;
                min-width: 1px;
                height: 0.6548vw;
                background: #004578; 
                margin-right: 0.9524vw;       
            }
            .post-cate:first-child:before {
                display: none;
            }
            .sticky-tag .sticky-text {
                font-size: 0.9524vw;
                text-transform: uppercase;
            }
            .sticky-tag .sticky-text:before {
                font-family: "iconfont";
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                content: '\e63f';
                font-size: 0.9524vw;
                margin-right: 0.4167vw;
            }
            .post-title {
                font-size: 1.3613vw;
                line-height: 2.381vw;
                margin-top: 0.5952vw;
                margin-bottom: 0;
                width: 39.881vw;
                word-break: break-all;
            }
            .post-title:after {
                display: flex;
                content: '';
                width: 4.1667vw;
                height: 0.2976vw;
                background: #004578;
                margin-top: 0.7321vw;
            }
            .post-title a {
                text-decoration: none;
                color: #000000;
            }
            .post-excerpt {
                margin-top: 1.4286vw;
                margin-bottom: 1.1905vw;
                font-size: 0.9524vw;
                line-height: 1.6667vw;
                color: #8A8A8A;
                display: -webkit-box;
                -webkit-box-orient: vertical;
                -webkit-line-clamp: 3;
                overflow: hidden;
                visibility:visible;
            }
            .flex-box {
                display: flex;
                align-items: center;
            }
            .meta-category {
                flex-wrap: wrap;
                padding-right: 4.1667vw;
            }
            .justify-between {
                justify-content: space-between;
            }
            .read-more {
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 0.8333vw;
                line-height: 0.8333vw;
                text-decoration: none;
                min-width: 9.1667vw;
                min-height: 2.1429vw;
                box-sizing: border-box;
                padding-left: 1.1905vw;
                padding-right: 1.1905vw;
                padding-top: 0.7143vw;
                padding-bottom: 0.7143vw;
                color: #004578;
                border: 0.0595vw #004578 solid;
                transition: all .2s;
                text-transform: uppercase;
            }
            .read-more:hover {
                background: #004578;
                color: white;
            }
            .icon-ml-readmore {
                margin-left: 0.625vw;
                font-size: 1.1905vw;
            }
            .post-meta-box {
                margin-top: 0.7143vw;
                font-size: 0.8333vw;
            }
            .post-meta {
                font-size: 0.8333vw;
                color: #1A1A1A;
                text-decoration: none;
                margin-left: 1.4881vw;
                display: inline-flex;
                align-items: center;
            }
            .icon-mr-postmeta {
                margin-right: 0.5952vw;
                font-size: 1.4881vw;
            }
            .post-meta .icon-like-sp {
                font-size: 1.1905vw;
            }
            .post-meta-box a.edit-link:after {
                content: '';
                display: flex;
                background: #979797;
                margin-left: 1.4881vw;
                width: 0.0595vw;
                height: 0.6548vw;
            }
            .post-publish-date {
                width: 4.1667vw;
                height: 4.7619vw;
                background: #F6F6F7;
                position: absolute;
                right: 1.2501vw;
                top: -0.8333vw;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }
            .post-publish-date .post-date {
                color: #004578;
                font-size: 1.3095vw;
                line-height: 2.2916vw;
                font-weight: bold;
            }
            .post-publish-date .post-month {
                color: #000000;
                font-size: 0.8333vw;
                line-height: 1.4583vw;
                text-transform: uppercase;
            }
            .list-box:last-child {
                margin-bottom: 2.381vw;
            }
            .pagination .screen-reader-text {
                display: none;
            }
            .nav-links {
                margin-top: 2.9762vw;
                margin-bottom: 2.9762vw;
                display: flex;
                justify-content: center;
                flex-wrap: wrap;
            }
            .nav-links .page-numbers,.nav-links .post-page-numbers {
                min-width: 2.1429vw;
                height: 2.1429vw;
                border: 0.0595vw #004578 solid;
                color: #004578;
                font-size: 1.0714vw;
                line-height: 1.0714vw;
                text-decoration: none;
                display: inline-flex;
                justify-content: center;
                align-items: center;
                margin-left: 0.4762vw;
                margin-right: 0.4762vw;
                margin-bottom: 0.4762vw;
                box-sizing: border-box;
            }
            .nav-links .current, .nav-links a.page-numbers:hover,.nav-links a.post-page-numbers:hover {
                background: #004578;
                color: white;
            }
            .pagination>.nav-links>.dots {
                border: none;
                padding-bottom: 0.5714vw;
            }
            @media only screen and (max-width: 640px){
                /* main body */
                main {
                    width: 100%;
                    flex-direction: column;
                    align-items: center;
                    padding-top: 6.6667vw;
                }
                .main-container {
                    width: 92vw;
                }
                .title-img {
                    width: 92vw;
                    height: 34.1333vw;
                }
                .post-info {
                    width: 92vw;
                    padding: 3.4667vw;
                    border: 0.2667vw solid #E6E6E6;
                }
                .post-publish-date {
                    width: 10.6667vw;
                    height: 12.1333vw;
                    top: -2vw;
                    right: 2.8vw;
                }
                .post-publish-date .post-date {
                    font-size: 3.4667vw;
                    line-height: 6.0667vw;
                }
                .post-publish-date .post-month {
                    font-size: 2.1333vw;
                    line-height: 3.7333vw;
                }
                .post-cate {
                    font-size: 3.4667vw;
                    line-height: 4.8vw;
                    margin-right: 2.2133vw;
                }
                .post-cate:before,
                .sticky-tag:before {
                    width: 0.1333vw;
                    height: 1.8933vw;
                    margin-right: 2.2vw;
                }
                .sticky-tag .sticky-text {
                    font-size: 2.9333vw;
                    line-height: 2.9333vw;
                }
                .sticky-tag .sticky-text:before {
                    font-size: 2.8vw;
                    margin-right: 2vw;
                }
                .post-title {
                    margin-top: 2.5333vw;
                    margin-bottom: 0;
                    font-size: 4.8vw;
                    line-height: 6.6667vw;
                    width: 74.4vw;
                }
                .post-title:after {
                    width: 9.3333vw;
                    height: 0.8vw;
                    margin-top: 2.2667vw;
                }
                .post-excerpt {
                    margin-top:3.3333vw;
                    margin-bottom: 3.3333vw;
                    font-size: 4vw;
                    line-height: 5.6vw;
                }
                .read-more {
                    font-size: 2.4533vw;
                    line-height: 2.4533vw;
                    min-width: 26.4933vw;
                    min-height: 6.1333vw;
                    padding-left: 3.7333vw;
                    padding-right: 3.7333vw;
                    padding-top: 2vw;
                    padding-bottom: 2vw;
                    border: 0.1333vw #004578 solid;
                }
                .icon-ml-readmore {
                    margin-left: 1.3333vw;
                    font-size: 3.3333vw;
                }
                .post-meta {
                    font-size: 2.1333vw;
                    margin-left: 3.2vw;
                }
                .icon-mr-postmeta {
                    margin-right: 1.8667vw;
                    font-size: 3.4667vw;
                }
                .post-meta-box a.edit-link:after {
                    margin-left: 3.2133vw;
                    width: 0.1333vw;
                    height: 1.68vw;
                }
                .post-meta .icon-like-sp {
                    font-size: 2.4vw;
                }
                .list-box {
                    margin-bottom: 5.3333vw;
                }
                .nav-links .page-numbers,.nav-links .post-page-numbers {
                    min-width: 8vw;
                    height: 8vw;
                    border: 0.1333vw #004578 solid;
                    font-size: 4vw;
                    line-height: 4vw;
                    margin-left: 1.7733vw;
                    margin-right: 1.7733vw;
                    margin-bottom: 1.7733vw;
                }
                .pagination>.nav-links>.dots {
                    padding-bottom: 2.6667vw;
                }
                .list-box:last-child {
                    margin-bottom: 5.3333vw;
                }
                .meta-category {
                    flex-wrap: wrap;
                    padding-right: 10.6667vw;
                }
            }  
            .sidebar {
                width: 19.6429vw;
                min-height: 29.7619vw;
            }
            .sidebar>aside:first-child {
                margin-top: 0;
            }
            .widget {
                width: 100%;
            }
            .widget-title {
                color: black;
                font-size: 1.0714vw;
                line-height: 1.0714vw;
                margin-top: 0;
                margin-bottom: 1.6667vw;
                text-transform: uppercase;
            }
            .widget-title:after {
                display: flex;
                margin-top: 1.1131vw;
                content: '';
                width: 3.7501vw;
                height: 0.119vw;
                min-height: 1.5px;
                background: #DEDEDE;
            }
            .widget {
                border-bottom: 0.0595vw #EBEBEB solid;
                padding-bottom: 2.1429vw;
                margin-bottom: 2.9762vw;
            }
            .widget:last-child {
                margin-bottom: 0;
                border-bottom: none;
            }
            .widget>ul {
                overflow-wrap: break-word;
                margin: 0;
                padding-left: 0;
                
            }
            .widget_categories>ul>li>ul.children>li.cat-item {
                color: black;
                font-size: 0.9524vw;
                margin-top: 1.1905vw;
            }
            .widget_categories>ul>li>ul.children>li.cat-item ul.children li {
                color: black;
                font-size: 0.9524vw;
                margin-top: 0.9524vw;
            }
            .widget_categories>ul>li.cat-item:before {
                content: '\e641';
                font-family: "iconfont";
                color: #004578;
                font-size: 0.9524vw;
                margin-right: 0.7143vw;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }
            .widget_categories>ul>li>ul.children {
                padding-left: 1.4286vw;
            }
            .widget_categories>ul>li>ul.children>li>ul.children {
                padding-left: 2.619vw;
            }
            .widget_categories>ul>li>ul.children>li>ul.children>li ul {
                padding-left: 1.3095vw;
            }
            .widget_categories ul.children {
                padding-left: 0.2976vw;
                display: flex;
                flex-direction: column;
            }
            .widget_categories>ul>li>ul.children>li:before {
                content: "\e642";
                display: inline-flex;
                font-family: "iconfont";
                color: #004578;
                font-size: 0.9524vw;
                margin-right: 0.5952vw;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }
            .widget_categories li.cat-item a {
                color: black;
                text-decoration: none;
            }
            .widget_categories ul{
                list-style: none;
            }
            .widget_categories .screen-reader-text {
                display: none;
            }
            /* common widgets */
            .widget ul li{
                font-size: 0.9524vw;
                line-height: 1.5476vw;
                margin-top: 1.25vw;
                list-style: none;
                position: relative;
                padding-left: 1.6667vw;
            }
            .widget ul li:first-child {
                margin-top: 0;
            }
            .widget ul li a {
                color: black;
                text-decoration: none;
            }
            .widget ul li a:hover {
                color: #004578;
            }
            .widget>ul>li:before {
                content: '\e62d';
                font-family: "iconfont";
                color: #004578;
                font-size: 0.893vw;
                margin-right: 0.7143vw;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                position: absolute;
                left: 0;
            }
            .widget .screen-reader-text {
                display: none;
            }
            /* search widgets */
            .widget_search form {
                display: flex;
                position: relative;
                align-items: center;
            }
            .widget_search {
                border-bottom: none;
                padding-bottom: 0;
            }
            .widget_search form input[type='text'] {
                width: 19.5833vw;
                height: 2.6787vw;
                border: 0.0595vw #E6E6E6 solid;
                border-radius: 0.2381vw;
                padding-left: 1.1905vw;
                padding-right: 2.9762vw;
                font-size: 0.8333vw;
            }
            .widget_search form input[type='text']::placeholder {
                font-size: 0.8333vw;
                color: #8A8A8A;
            }
            .widget_search form button[type='submit'] {
                position: absolute;
                right: 0;
                padding: 0;
                border: none;
                background: unset;
                z-index: 1;
                cursor:pointer;
            }
            .widget_search form button[type='submit']:before {
                content: '\e62c';
                font-family: "iconfont";
                color: #B0B0B0;
                font-size: 1.7857vw;
                margin-right: 0.7143vw;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }
            /* profile widgets */
            .widget_profile {
                padding-bottom: 0;
                border-bottom: 0;
            }
            .widget_profile .profile-box {
                width:19.6429vw;
                min-height:9.2262vw;
                border:0.0595vw #E6E6E6 solid;
                display: flex;
                justify-content: center;
                position: relative;
                margin-top: 2.6787vw;
            }
            .widget_profile .profile-avatar {
                width: 5.3571vw;
                height: 5.3571vw;
                position: absolute;
                top: -2.6787vw;
            }
            .widget_profile .profile-avatar img {
                border-radius: 100%;
            }
            .widget_profile .profile-content {
                font-size: 0.9524vw;
                padding: 2.9762vw 1.6667vw 1.9048vw 1.6667vw;
                width: 100%;
                box-sizing: border-box;
                word-break: break-word;
                line-height: 1.8;
            }
            .widget_profile .profile-content li {
                margin-top: 0.5952vw;
            }
            .widget_profile  ol, .widget_profile ul {
                padding-left: 0.9524vw;
                margin-top: 0.5952vw;
                margin-bottom: 0.5952vw;
            }
            .widget_profile  .profile-content p {
                margin-block-start: auto;
                margin-block-end: auto;
                margin-top: 0.5952vw;
            }
            .widget_profile img {
                max-width: 100%;
                height: auto;
            }
            .widget_profile .wp-video, .widget_profile .wp-video video{
                max-width: 100%;
                height: auto;
            }
            .widget_profile a {
                font-size: 0.9524vw;
                color: #004578;
                text-decoration: none;
            }
            .widget ul li span, .widget ul li a {
                color: black;
            }
            .widget ul li span.post-date {
                color: #888888;
                font-style: italic;
            }
            li.recentcomments {
                color: #888888;
            }
            @media only screen and (max-width: 640px){
                /* side bar */
                .sidebar {
                    width: 92vw;
                    margin-top: 8vw;
                }
                .widget_profile .profile-box {
                    width: 92vw;
                    margin-top: 12.5333vw;
                    border: 0.2667vw #E6E6E6 solid;
                }
                .widget_profile .profile-avatar {
                    width: 25.0667vw;
                    height: 25.0667vw;
                    top: -12.5333vw;
                }
                .widget_profile .profile-content{
                    font-size: 4vw;
                    line-height: 5.8667vw;
                    padding: 17.8667vw 8.0667vw 4.8267vw 8.0667vw;
                }
                .widget_profile .profile-content li {
                    font-size: 4vw;
                    line-height: 5.8667vw;
                    margin-top: 1.3333vw;
                    list-style: unset;
                }
                .widget_profile  ol, .widget_profile ul {
                    padding-left: 2.1333vw;
                    margin-top: 1.3333vw;
                    margin-bottom: 1.3333vw;
                }
                .widget_profile  .profile-content p {
                    margin-block-start: auto;
                    margin-block-end: auto;
                    margin-top: 1.3333vw;
                }
                .widget_profile img {
                    max-width: 100%;
                    height: auto;
                }
                .widget_profile a {
                    font-size: 4vw;
                    color: #004578;
                    text-decoration: none;
                }
                .widget_search {
                    margin-top: 8vw;
                    margin-bottom: 8vw;
                }
                .widget_search form input[type='text'] {
                    width: 92vw;
                    height: 10.6667vw;
                    border: 0.2667vw #E6E6E6 solid;
                    border-radius: 0.5333vw;
                    padding-left: 5.3333vw;
                    padding-right: 6.6667vw;
                    font-size: 4vw;
                }
                .widget_search form input[type='text']::placeholder {
                    font-size: 4vw;
                }
                .widget_search form button[type='submit']:before {
                    font-size: 6.4vw;
                    margin-right: 4.1333vw;
                }
                .widget {
                    border-bottom: 0.2667vw #EBEBEB solid;
                    padding-bottom: 8.0667vw;
                    margin-bottom: 8.0667vw;
                }
                .widget_search,.widget_profile {
                    border-bottom: none;
                    padding-bottom: 0;
                }
                .widget:last-child {
                    margin-bottom: 0;
                    border-bottom: none;
                }
                .widget-title {
                    font-size: 4.5333vw;
                    line-height: 4.5333vw;
                    margin-bottom: 7.4133vw;
                }
                .widget-title:after {
                    margin-top: 4.5067vw;
                    width: 15.2133vw;
                    height: 0.48vw;
                }
                .widget_categories>ul>li.cat-item:before {
                    font-size: 3.6vw;
                    margin-right: 2.8933vw;
                }
                .widget ul li {
                    font-size: 4vw;
                    line-height: 6.6667vw;
                    margin-top: 4vw;
                    padding-left: 6.6667vw;
                }
                .widget_categories>ul>li>ul.children {
                    padding-left: 3.7333vw;
                }
                .widget_categories>ul>li>ul.children>li:before {
                    font-size: 4vw;
                    margin-right: 1.3333vw;
                }
                .widget_categories>ul>li>ul.children>li.cat-item {
                    font-size: 3.3333vw;
                    margin-top:2.6667vw;
                }
                .widget_categories>ul>li>ul.children>li>ul.children {
                    padding-left: 6.6667vw;
                }
                .widget_categories>ul>li>ul.children>li.cat-item ul.children li {
                    font-size: 3.3333vw;
                    margin-top:2.6667vw;
                }
                .widget>ul>li:before {
                    font-size: 3.6vw;
                    margin-right: 2.5333vw;
                }
            }  
            /* common bottom */
            footer {
                width: 100vw;
                background: #000000;
                display: flex;
                justify-content: center;
            }
            .footer-container {
                width: 71.4286vw;
                height: 100%;
                display: flex;
                justify-content: center;
                flex-direction: column;
            }
            .footer-container .footer-copyright {
                margin-bottom: 1.1905vw;
                margin-top: 2.893vw;
            }
            .footer-container .footer-copyright, .footer-container .footer-copyright a{
                text-align: center;
                font-size: 0.8333vw;
                color: #8A8A8A;
                line-height: 0.5952vw;
                text-decoration: none;
            }
            .footer-menus>nav {
                margin-top: 2.893vw;
                margin-bottom: 0.875vw;
            }
            .footer-menus>nav>ul {
                display: flex;
                margin-top: 0;
                margin-bottom: 0;
                display: flex;
                justify-content: center;
            }
            .footer-menus>nav>ul>li {
                font-size: 1.0714vw;
                line-height: 1.0714vw;
                text-transform: uppercase;
                display: flex;
                flex-direction: column;
            }
            .footer-menus>nav>ul>li>a:after {
                display: flex;
                content: '';
                margin-top: 0.7798vw;
                width: 2.381vw;
                height: 0.119vw;
                background: #444444;
            }
            .footer-menus>nav>ul>li>a {
                color: #004578;
            }
            .footer-menus>nav a {
                text-decoration: none;
                font-size: 1.0714vw;
            }
            .footer-menus>nav ul, .footer-menus>nav li {
                list-style: none;
                justify-content: space-around;
                justify-content: space-evenly;
                display: flex;
                padding-left: 0;
            }
            .footer-menus>nav>ul>li .sub-menu {
                display: flex;
                flex-direction: column;
                text-transform: none;
            }
            .footer-menus>nav>ul>li ul li {
                margin-top: 1.2143vw;
                line-height: 0.9524vw;
                display: flex;
                justify-content: start;
            }
            .footer-container a:hover {
                color:#004578;
            }
            .footer-menus>nav>ul>li ul li:first-child {
                margin-top: 0.893vw;
            }
            .footer-menus>nav>ul>li ul li a{
                font-size: 0.9524vw;
                color: rgba(255,255,255,0.6);
                display: flex;
            }
            @media only screen and (max-width: 640px){
                /* footer */
                .footer-container {
                    width: 100%;
                    padding-top: 8.1333vw;
                    padding-bottom: 5.3333vw;
                }
                .footer-menus>nav>ul>li {
                    font-size: 3.7333vw;
                    line-height: 3.7333vw;
                    margin-bottom: 13.3333vw;
                    min-width: 33.4667vw;
                    margin-left: 4vw;
                    margin-right: 4vw
                }
                .footer-menus>nav a {
                    font-size: 3.7333vw;
                }
                .footer-menus>nav>ul>li>a:after {
                    margin-top: 2.8vw;
                    width: 8.5467vw;
                    height: 0.4267vw;
                }
                .footer-menus>nav>ul>li ul li:first-child {
                    margin-top: 3.1733vw;
                }
                .footer-menus>nav>ul>li ul li {
                    margin-top: 4.3067vw;
                    font-size: 3.4667vw;
                    line-height: 3.4667vw;
                }
                .footer-menus>nav>ul>li ul li a {
                    font-size: 3.4667vw;
                }
                .footer-menus>nav>ul {
                    flex-wrap: wrap;
                    justify-content: space-between;
                    box-sizing: border-box;
                    padding: 0 8.5334vw 0 8.5334vw;
                }
                .footer-menus>nav {
                    margin: 0;
                }
                .footer-container .footer-copyright, .footer-container .footer-copyright a {
                    font-size: 2.9333vw;
                    line-height: 2.9333vw;
                }
                .footer-container .footer-copyright p {
                    margin-top: 0;
                }
                .footer-container .footer-copyright {
                    margin-top: 0;
                    margin-bottom: 0;
                }
            }
                .content {
                    word-break: break-word;
                }
                .content * {
                    max-width: 100%;
                }
                hr {
                    border: none;
                    background: #e6e6e6;
                    width: 100%;
                    height: 0.0595vw;
                    margin-top: 2.381vw;
                    margin-bottom: 2.381vw;
                }
                .post-password-form>p>label>input {
                    margin-left: 0.893vw;
                    margin-right: 0.8333vw;
                    width: 19.0476vw;
                    height: 2.381vw;
                    border-radius: 0.2381vw;
                    border: 0.0595vw #E6E6E6 solid;
                    padding-left: 1.1905vw;
                    padding-right: 1.1905vw;
                    vertical-align: middle
                } 
                .post-password-form>p>input {
                    font-size: 0.9524vw;
                    color: white;
                    background: #464646;
                    border-radius: 0.2381vw;
                    padding: 0.8452vw 1.131vw 0.8452vw 1.131vw;
                    border: none;
                }
                .content figure{
                    margin: 0;
                }
                h2.article-title {
                    margin-top: 1.3095vw;
                    font-size: 1.9048vw;
                    line-height: 2.8571vw;
                    margin-bottom: 1.9048vw;
                }
                h2.article-title a {
                    color: black;
                    text-decoration: none;
                }
                .article-info .post-meta-box {
                    margin-top: 0;
                }
                .article-info .post-meta-box a.edit-link:after {
                    display: none;
                }
                .article-info .post-meta-box a.edit-link:before {
                    content: '';
                    display: flex;
                    background: #979797;
                    margin-right: 1.4881vw;
                    width: 0.0595vw;
                    height: 0.6548vw;
                }
                .article-info .post-meta:first-child {
                    margin-left: 0;
                }
                .article-info .post-meta-box {
                    margin-bottom: 0.9524vw;
                }
                .content blockquote {
                    margin-left:0;
                    margin-right:0;
                    margin-top: 1.4286vw;
                    margin-bottom: 1.4286vw;
                    position: relative;
                    padding-left: 3.5714vw;
                }
                .content blockquote p {
                    margin: 0;
                    font-size: 1.3095vw;
                    line-height: 1.9048vw;
                    color: black;
                }
                .content blockquote:before {
                    content: '\e648';
                    font-family: "iconfont";
                    color: #E6E6E6;
                    font-size: 2.1072vw;
                    margin-right: 1.6667vw;
                    -webkit-font-smoothing: antialiased;
                    -moz-osx-font-smoothing: grayscale;
                    position: absolute;
                    left: 0;
                }
                .content h1,
                .content h2,
                .content h3,
                .content h4,
                .content h5,
                .content h6 {
                    margin-top: 1.7857vw;
                    margin-bottom: 1.7857vw;
                }
                .content h1 {
                    font-size: 1.6667vw;
                }
                .content h2 {
                    font-size: 1.5476vw;
                }
                .content h3 {
                    font-size: 1.4286vw;
                }
                .content h4 {
                    font-size: 1.3095vw;
                }
                .content h5 {
                    font-size: 1.1905vw;
                }
                .content h6 {
                    font-size: 1.0714vw;
                }  
                .content p {
                    margin-top: 2.0238vw;
                    margin-bottom: 2.0238vw;
                    font-size: 1.0714vw;
                    line-height: 1.9048vw;
                    color: #666666;
                    display: flex;
                } 
                .content .aligncenter {
                margin-left: auto;
                margin-right: auto;
                }
                .content>figure {
                    margin: 2.0238vw 0 2.0238vw 0;
                }
                
                .blocks-gallery-item figure img{
                    display: flex;
                }
                .content ul, .content ol {
                    padding-left: 1.4881vw;
                    font-size: 1.0714vw;
                    line-height: 1.9048vw;
                    margin-top: 2.0238vw;  
                    margin-bottom: 2.0238vw;  
                }
                .content figcaption {
                    font-size: 1.1905vw;
                    color: #666666;
                    text-align: center;
                    margin-top: 0.2976vw;
                }
                .wp-block-cover {
                    margin: 2.0238vw 0 2.0238vw 0;
                }
                .wp-block-cover-image, .wp-block-cover {
                    position: relative;
                    background-color: #000;
                    background-size: cover;
                    background-position: center center;
                    min-height: 25.5952vw;
                    height: 100%;
                    width: 100%;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    overflow: hidden;
                }
                .wp-block-cover-image.has-background-dim::before, 
                .wp-block-cover.has-background-dim::before {
                    content: "";
                    position: absolute;
                    top: 0;
                    left: 0;
                    bottom: 0;
                    right: 0;
                    background-color: inherit;
                    opacity: 0.5;
                    z-index: 1;
                }
                .wp-block-cover .wp-block-cover__inner-container p {
                    margin: 0;
                    text-align: center;
                }
                .wp-block-cover-image .wp-block-cover__inner-container, .wp-block-cover .wp-block-cover__inner-container {
                    z-index: 1;
                    color: #f8f9f9;
                }
                .wp-block-cover__inner-containe,.wp-block-cover__inner-container p {
                    color:white;
                    font-size:1.7857vw;
                }
                figure.wp-block-gallery ul{
                    list-style: none;
                    padding: 0;
                    margin: 0;
                    max-width: 100%;
                    display: flex;
                    justify-content: space-between;
                }
                li.blocks-gallery-item {
                    max-width: 100%;
                }
                .wp-block-gallery ul li figure {
                    margin: 0;
                    position: relative;
                }
                .wp-block-gallery ul li figure>figcaption {
                    position: absolute;
                    bottom: 0;
                    width: 100%;
                    font-size: 1.1905vw;
                    line-height: 1.7857vw;
                    padding-top: 1.3542%;
                    padding-bottom: 1.0417%;
                    margin: 0;
                    color: white;
                    background: linear-gradient(to top, rgba(13,13,13,0.85), transparent);
                }
                .wp-block-gallery, .blocks-gallery-grid {
                    display: flex;
                    flex-wrap: wrap;
                    list-style-type: none;
                    padding: 0;
                    margin: 0;
                }
                .wp-block-gallery ul>li {
                    margin-bottom: 0.9524vw;
                }
                
                .wp-block-gallery ul>li:first-child:last-child
                {
                    width: 100%;
                }
                .wp-block-gallery ul>li:first-child:nth-last-child(n+2),
                .wp-block-gallery ul>li:first-child:nth-last-child(n+2) ~ li
                {
                    width: calc((100% - 3%) / 2);
                }
                .wp-block-gallery ul>li:first-child:nth-last-child(3n),
                .wp-block-gallery ul>li:first-child:nth-last-child(3n) ~ li
                {
                    width: calc((100% - 3%) / 3);
                }
                .wp-block-file {
                    background: #F6F6F7;
                    padding-left: 1.4881vw;
                    padding-right: 1.0119vw;
                    padding-top: 1.0714vw;
                    padding-bottom: 1.0714vw;
                    margin: 2.0238vw 0 2.0238vw 0;
                    font-size: 0.9524vw;
                    line-height: 2.381vw;
                }
                .wp-block-file:before {
                    content: 'Download:';
                    color: black;
                    margin-right: 0.5952vw;
                }
                .wp-block-file a:last-child,
                a.wp-block-file__button {
                    float: right;
                    display:flex;
                    padding: 0.7143vw 1.131vw 0.7143vw 1.131vw;
                    border: 0.0595vw #004578 solid;
                    line-height: 0.7619vw;
                }
                .wp-block-file a:last-child:hover,
                a.wp-block-file__button:hover {
                    background: #004578;
                    color: white;
                }
                .wp-block-file a:last-child:after,
                a.wp-block-file__button:after {
                    content: '\e645';
                    font-family: "iconfont";
                    font-size: 0.9524vw;
                    margin-left: 0.8333vw;
                    -webkit-font-smoothing: antialiased;
                    -moz-osx-font-smoothing: grayscale;
                }
                .content a {
                    color: #004578;
                    text-decoration: none;
                }
                .content .wp-block-code {
                    width: 100%;
                    background: #F6F6F7;
                    padding: 0.9524vw;
                    font-size: 1.1905vw;
                    line-height: 1.7857vw;
                    color: #666666;
                    box-sizing: border-box;
                }
                .wp-block-table table {
                    width: 100%;
                    border-collapse: collapse;
                    font-size: 1.1905vw;
                }
                .wp-block-table table td {
                    color: #666666;
                    border: 0.0595vw #cccccc solid;
                    padding: 0.4762vw;
                }
                .wp-block-button {
                    margin: 2.0238vw 0 2.0238vw 0;
                }
                .wp-block-button a {
                    text-decoration: underline;
                }
                .wp-block-media-text {
                    display: flex;
                    margin: 2.0238vw 0 2.0238vw 0;
                }
                .wp-block-media-text figure {
                    width: 50%;
                    margin: 0;
                }
                .wp-block-media-text .wp-block-media-text__content {
                    margin-left: 0.893vw;
                }
                
                .wp-block-column {
                    flex-grow: 1;
                    min-width: 0;
                    word-break: break-word;
                    overflow-wrap: break-word;
                }
                .wp-block-columns {
                    flex-wrap: nowrap;
                    display: flex;
                }
                .likes-form {
                    text-align: center;
                    margin-bottom: 3.5714vw;
                }
                .likes-button {
                    width: 4.7619vw;
                    height: 4.7619vw;
                    border-radius: 100%;
                    border: 0.0595vw solid #C4C4C4;
                    background: white;
                    color: #1A1A1A;
                    font-size: 0.8333vw;
                    display: inline-flex;
                    flex-direction: column;
                    justify-content: center;
                    align-items: center;
                }
                .likes-button:hover,.likes-button-active{
                    color: #004578;
                }
                .likes-button:before {
                    content: '\e64a';
                    font-family: "iconfont";
                    font-size: 1.9048vw;
                    margin-bottom: 0.3571vw;
                    -webkit-font-smoothing: antialiased;
                    -moz-osx-font-smoothing: grayscale;
                }
                .likes-form .likes-button-active:before {
                    content: '\e63d';
                }
                .post-nav {
                    display: flex;
                    justify-content: space-between; 
                    margin-bottom: 4.5238vw;           
                }
                .post-nav .nav-previous a,.post-nav .nav-next a {
                    color: #c5c5c5;
                    font-size: 1.0714vw;
                    text-decoration: none;
                    font-weight: bold;
                    display: inline-flex;
                }
                .post-nav a.post-nav-link-active {
                    color: black;
                }
                .post-nav a.post-nav-link-active:hover {
                    color: #004578;
                }
                .post-nav .nav-previous a:before {
                    content: '\e640';
                    font-family: "iconfont";
                    font-size: 1.5476vw;
                    margin-right: 0.875vw;
                    -webkit-font-smoothing: antialiased;
                    -moz-osx-font-smoothing: grayscale;         
                }
                .post-nav .nav-next a:after {
                    content: '\e649';
                    font-family: "iconfont";
                    font-size: 1.5476vw;
                    margin-left: 0.875vw;
                    -webkit-font-smoothing: antialiased;
                    -moz-osx-font-smoothing: grayscale;         
                }
                .social-share {
                    display: flex;
                    max-width: 100%;
                }
                .social-share-box {
                    width: 2.9762vw;
                    height: 2.9762vw;
                    margin-right: 1.7857vw;
                }
                amp-social-share.rounded {
                    display: flex;
                    border-radius: 50%;
                    background-size: 60%;
                    color: #fff;
                    background-color: black;
                }
                amp-social-share.rounded:hover {
                    background-color: #004578;
                }
                .post-tags {
                    display: flex;
                    margin-top: 1.9644vw;
                flex-wrap: wrap;
                }
                .post-tags a{
                    display: inline-flex;
                    background: #F2F2F2;
                    padding-left: 1.3393vw;
                    padding-right: 1.3393vw;
                    padding-top: 0.6548vw;
                    padding-bottom: 0.6548vw;
                    margin-right: 0.3571vw;
                margin-bottom: 0.3571vw;
                    color: #666666;
                    font-size: 0.8333vw;
                    line-height: 0.8333vw;
                    text-decoration: none;
                    text-transform: uppercase;
                }
                #comments {
                    margin-top: 4.7619vw;
                }
                .comments>h2 {
                    text-align: center;
                    margin-bottom: 3.5714vw;
                    font-size: 1.0714vw;
                    line-height: 1.0714vw;
                    text-transform: uppercase;
                }
                .comments>ul {
                    list-style: none;
                    padding-left: 0.9524vw;
                    margin-top: 0;
                    margin-bottom: 1.7857vw;
                }
                .comments>ul .comment-author .avatar {
                    border-radius: 100%;
                    width: 4.7619vw;
                    height: 4.7619vw;
                    position: absolute;
                    left: 0.9524vw;
                }
                .comments>ul cite.fn a {
                    font-weight: bold;
                    font-size: 1.0714vw;
                    color: black;
                    font-style: normal;
                }
                .comments>ul span.says {
                    display: none;
                }
                .comments>ul cite.fn {
                    font-weight: bold;
                    font-style: normal;
                }
                .comments>ul .comment-meta a:first-child{
                    color: #B5B5B5;
                    font-size: 0.9524vw;
                    line-height: 0.9524vw;
                    font-style: italic;
                }
                .comments>ul .comment-meta {
                    margin-bottom: 1.9048vw;
                }
                .comments>ul .comment-body {
                    position: relative;
                    padding-left: 7.7381vw;
                    padding-bottom: 0.5952vw;
                    padding-top: 2.381vw;
                    
                }
                #comments>ul>li.comment ul {
                    list-style: none;
                }
                #comments>ul>li.comment ul .comment-body:before {
                    content: ' ';
                    height: 2.9762vw;
                    width: 0.2381vw;
                    background: #EEEEEE;
                    display: flex;
                    position: absolute;
                    left: -0.5952vw;
                    top: 3.2738vw;
                }
                #comments>ul>li.comment {
                    border-bottom: 0.0595vw solid #E6E6E6;
                }
                #comments>ul>li.comment:last-child {
                    border-bottom: none;
                }
                .comments>ul .comment-body .reply {
                    text-transform: uppercase;
                    position: absolute;
                    right: 0;
                    top: 2.381vw;
                    font-size: 1.0714vw;
                }
                .comment-respond .comment-reply-title{
                    font-size: 1.0714vw;
                    text-transform: uppercase;
                }
                .comment-respond .comment-reply-title>small {
                    text-transform: uppercase;
                    float: right
                }
                .comment-form {
                    font-size: 0;  /* css hack for fix blank position */
                }
                .comment-form>.logged-in-as a:first-child {
                    color: #666666;
                }
                .comment-form>.logged-in-as {
                    margin-bottom: 1.7857vw;
                }
                .comment-form>.form-submit {
                    margin-bottom: 4.7619vw
                }
                .comment-form .comment-error {
                    color: red;
                    font-size: 1.0714vw;
                    margin-bottom: 0.2976vw;
                }
                .comment-form-comment .comment-content {
                    width: 48.2143vw;
                    height: 11.9048vw;
                    resize: none;
                    border: 0.0595vw #E6E6E6 solid;
                    padding: 1.1905vw 1.3095vw 1.1905vw 1.3095vw;
                    font-size: 1.0952vw;
                    line-height: 1.0952vw;
                    box-sizing: border-box;
                }
                .comment-form-comment .comment-content::placeholder {
                    font-size: 1.0952vw;
                    line-height: 1.0952vw;
                }
                .comment-form>.form-submit>.submit {
                    border: 0.0595vw solid #004578;
                    text-transform: uppercase;
                    color: #004578;
                    font-size: 1.0952vw;
                    line-height: 1.0952vw;
                    background: white;
                    box-sizing: border-box;
                    padding: 0.9644vw 1.5059vw 0.9644vw 1.5059vw;
                    cursor: pointer;
                }
                .comment-form>.form-submit>.submit:hover {
                    background: #004578;
                    color: white; 
                }
                .comment-form-author {
                    margin-right: 1.3095vw;
                }
                .comment-form-author,
                .comment-form-email,
                .comment-form-url
                {
                    display: inline-flex;
                }
                .comment-form-author input,
                .comment-form-email input,
                .comment-form-url input
                {
                    width: 23.4524vw;
                    height: 3.4524vw;
                    border: 0.0595vw solid #E6E6E6;
                    padding:  1.369vw;
                    font-size: 0.9524vw;
                    line-height: 0.9524vw;
                    color: #333333;
                    box-sizing: border-box;
                }
                .comment-form-url input {
                    width: 48.2143vw;
                }
                #wp-comment-cookies-consent {
                    width: 1.0714vw;
                    height: 1.0714vw;
                    margin: 0;
                    vertical-align: middle;
                    margin-right: 0.2976vw;
                } 
                .comment-form-cookies-consent>label {
                    color: #B5B5B5;
                    font-size: 0.9524vw;
                    line-height: 0.9524vw;
                }
                @media only screen and (max-width: 640px){
                    .likes-form {
                        margin-bottom: 8vw;
                    }
                    .article-info .post-meta-box a.edit-link:before {
                        margin-right: 3.2133vw;
                        width: 0.1333vw;
                        height: 1.68vw;
                    }
                    h2.article-title {
                        margin-top: 5.3333vw;
                        font-size: 5.0667vw;
                        line-height: 6.9334vw;
                        margin-bottom: 5.3333vw;
                    }
                    .article-info .post-meta-box {
                        margin-bottom: 0;
                    }
                    .content blockquote {
                        margin-top: 6.4666vw;
                        margin-bottom: 6.4666vw;
                        padding-left: 8vw;   
                    }
                    .content blockquote:before {
                        font-size: 4.7201vw;
                        margin-right: 3.7333vw;
                    }
                    .content blockquote p {
                        font-size: 4vw;
                        line-height: 5.6vw;
                    }
                    .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
                        margin-top: 5.3333vw;
                        margin-bottom: 5.3333vw;
                    }
                    .content h1 {
                        font-size: 5.6vw;
                    }
                    .content h2 {
                        font-size: 5.3333vw;
                    }  
                    .content h3 {
                        font-size: 5.0667vw;
                    } 
                    .content h4 {
                        font-size: 4.8vw;
                    } 
                    .content h5 {
                        font-size: 4.5333vw;
                    } 
                    .content h6 {
                        font-size: 4.2667vw;
                    } 
                    .content p {
                        margin-top: 4.5333vw;
                        margin-bottom: 4.5333vw;
                        font-size: 4vw;
                        line-height: 5.8667vw;
                    }
                    .content ul, .content ol {
                        padding-left: 3.3333vw;
                        font-size: 4vw;
                        line-height: 5.8667vw;  
                        margin-top: 5.3333vw;    
                        margin-bottom: 5.3333vw;    
                    }
                    .content figcaption {
                        font-size: 3.2vw;
                        margin-top: 0.6666vw;
                    }
                    .content>figure {
                        margin: 4.5333vw 0 4.5333vw 0;
                    }
                    .wp-block-cover-image, .wp-block-cover {
                        min-height: 50vw;
                        margin: 4.5333vw 0 4.5333vw 0;
                    }
                    .wp-block-gallery ul>li {
                        margin-bottom: 2.1333vw;
                    }
                    .content .wp-block-code {
                        padding: 2.1333vw;
                        font-size: 3.3vw;
                        line-height: 4.2667vw; 
                    }
                    .wp-block-table table {
                        font-size: 3.4667vw;
                    }
                    .wp-block-file {
                        padding-left: 3.4667vw;
                        padding-right: 2.6667vw;
                        padding-top: 1.3333vw;
                        padding-bottom: 1.3333vw;
                        margin: 4.5333vw 0 4.5333vw 0;
                        font-size: 3.4667vw;
                        line-height: 5.3333vw;
                    }
                    .wp-block-file a:last-child, a.wp-block-file__button {
                        padding: 1.6vw 3.2vw 1.6vw 3.2vw;
                        border: 0.1333vw #004578 solid;
                        line-height: 2.1333vw;
                    }
                    .wp-block-file a:last-child:after, a.wp-block-file__button:after {
                        font-size: 2.6667vw;
                        margin-left: 2.4vw;
                    }
                    
                    .nav-links {
                        margin-top: 4.5333vw;
                        margin-bottom: 4.5333vw;
                    }
                    .wp-block-button {
                        margin: 4.5333vw 0 4.5333vw 0;
                    }
                    .likes-button {
                        width: 16vw;
                        height: 16vw;
                        border: 0.1333vw solid #C4C4C4;
                        font-size: 2.6667vw;
                        margin-top: 2.6667vw;
                    }
                    .likes-button:before {
                        font-size: 5.6vw;
                        margin-bottom: 1.8667vw;
                    }
                    .post-nav {
                        margin-bottom: 12.6667vw;           
                    }
                    .post-nav .nav-previous a, .post-nav .nav-next a {
                        font-size: 3.7333vw;
                    }
                    .social-share-box {
                        width: 6.6667vw;
                        height: 6.6667vw;
                        margin-right: 4vw;
                    }
                    .post-tags {
                        margin-top: 8.8vw;;
                    }
                    .post-tags a{
                        padding-left: 3.5333vw;
                        padding-right: 3.5333vw;
                        padding-top: 1.7333vw;
                        padding-bottom: 1.7333vw;
                        margin-right: 1.3333vw;
                        font-size: 2.2vw;
                        line-height: 2.2vw;
                    }
                    .comments>ul .comment-author .avatar {
                        width: 10.6667vw;
                        height: 10.6667vw;
                        left: 0;
                    }
                    #comments>ul {
                        padding-left: 0;
                    }
                    .comments>ul .comment-body {
                        padding-left: 15.7067vw;
                        padding-bottom: 1.8667vw;
                        padding-top: 5.3333vw;         
                    }
                    .comments>ul cite.fn a {
                        font-size: 3.7333vw;
                    }
                    .comments>ul .comment-meta a:first-child {
                        font-size: 3.2vw;
                        line-height: 3.2vw;
                    }
                    .comments>ul .comment-body .reply {
                        font-size: 3.7333vw;
                        top: 5.3333vw;       
                    }
                    .comments>h2,.comment-respond .comment-reply-title {
                        font-size: 3.7333vw;
                    }
                    .comment-form-comment .comment-content {
                        width: 92vw;
                        height: 26.6667vw;
                        border: 0.1333vw #E6E6E6 solid;
                        padding: 4vw 3.3333vw 4vw 3.3333vw;
                        font-size: 3.4667vw;
                        line-height: 3.4667vw;     
                    }
                    .comment-form-comment .comment-content::placeholder {
                        font-size: 3.4667vw;
                        line-height: 3.4667vw;   
                    }
                    .comment-form>.form-submit>.submit {
                        border: 0.1333vw solid #004578;
                        font-size: 3.2vw;
                        line-height: 3.2vw;
                        padding: 2.8133vw 4.4vw 2.8133vw 4.4vw;
                        cursor: pointer;
                    }
                    .comment-form .comment-error {
                        font-size: 3.4667vw;
                    }
                    #comments>ul>li.comment {
                        border-bottom: 0.1333vw solid #E6E6E6;
                    }
                    .comment-form-author input, .comment-form-email input, .comment-form-url input {
                        width: 92vw;
                        height: 10.6667vw;
                        border: 0.1333vw solid #E6E6E6;
                        padding: 2.5333vw;
                        font-size: 3.4667vw;
                        line-height: 3.4667vw;
                    }
                    #wp-comment-cookies-consent {
                        width: 5.3333vw;
                        height: 5.3333vw;
                        margin-right: 1.3333vw;
                    }
                    .comment-form-cookies-consent>label {
                        font-size: 3.2vw;
                        line-height: 4.8vw;
                    }
                    .comment-form-cookies-consent {
                        display: flex;
                    }
                    .post-nav .nav-previous a:before {
                        font-size: 5.3333vw;
                        margin-right: 2.8vw;         
                    }
                    .post-nav .nav-next a:after {
                        font-size: 5.3333vw; 
                        margin-left: 2.8vw;        
                    }
                    hr {
                        height: 0.1333vw;
                        margin-top: 5.3333vw;
                        margin-bottom: 5.3333vw;
                    }
                    .post-password-form>p>label>input {
                        margin-left: 2.0001vw;
                        margin-right: 1.8667vw;
                        width: 42.6667vw;
                        height: 5.3333vw;
                        border-radius: 0.5333vw;
                        border: 0.1334vw #E6E6E6 solid;
                        padding-left: 2.6667vw;
                        padding-right: 2.6667vw;
                    } 
                
                    .post-password-form>p>input {
                        font-size: 2.1333vw;
                        border-radius: 0.5333vw;
                        padding: 1.8934vw 2.5334vw 1.8934vw 2.5334vw;
                    }
                    #comments>ul>li.comment ul .comment-body:before {
                        height: 6.6667vw;
                        width: 0.5333vw;
                        left: -3.3333vw;
                        top: 7.3334vw;
                    }
                    #comments {
                        margin-top: 12vw;
                    }
                    .wp-block-table table td {
                        border: 0.2667vw #cccccc solid;
                        padding: 1.0667vw;
                    }
                    .wp-block-gallery ul li figure>figcaption {
                        font-size: 1.7333vw;
                        line-height: 2.9333vw;
                    }
                }
                pre, code {
                font-family: "Lucida Console", Monaco, monospace;
                font-size: 12pt;
                background-color: #F1F1F1;
                    padding: .5em;
                }
                code {
                    padding: 0.1em;
                }
                :root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-681d4ff{text-align:center;margin-top:.5vw}
            </style>
    


<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
<link rel="canonical" href="http://blog.zerokirin.online/post/channel-di-ceng-ru-he-shi-xian-zu-sai-de/" />
<link rel="shortcut icon" href="http://blog.zerokirin.online/favicon.ico?v=1625004844759">

<meta name="author" content="破庙主任">

<meta itemprop="name" content="Channel底层如何实现阻塞的 | Zer0kiriN">
<meta itemprop="description" content="
每日一问系列（一）

我们都知道，channel在缓冲区满或者无缓冲的时候，发送数据会阻塞，缓冲区空或无缓冲的时候，接受也会阻塞
那么这个阻塞，是怎么实现的呢？
之前我们只是粗略的讲解了channel的实现的结构体，这次我们详细的看看发送...">
<meta itemprop="image" content="">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Channel底层如何实现阻塞的 | Zer0kiriN">
<meta name="twitter:description" content="
每日一问系列（一）

我们都知道，channel在缓冲区满或者无缓冲的时候，发送数据会阻塞，缓冲区空或无缓冲的时候，接受也会阻塞
那么这个阻塞，是怎么实现的呢？
之前我们只是粗略的讲解了channel的实现的结构体，这次我们详细的看看发送...">
<meta name="twitter:image" content="" />
<meta name="twitter:image:alt" content="Channel底层如何实现阻塞的 | Zer0kiriN" />


<meta property="og:type" content="website">
<meta property="og:url" content="http://blog.zerokirin.online/post/channel-di-ceng-ru-he-shi-xian-zu-sai-de/">
<meta property="og:title" content="Channel底层如何实现阻塞的 | Zer0kiriN">
<meta property="og:description" content="
每日一问系列（一）

我们都知道，channel在缓冲区满或者无缓冲的时候，发送数据会阻塞，缓冲区空或无缓冲的时候，接受也会阻塞
那么这个阻塞，是怎么实现的呢？
之前我们只是粗略的讲解了channel的实现的结构体，这次我们详细的看看发送...">
<meta property="og:image" content="">
<meta property="og:image:alt" content="Channel底层如何实现阻塞的 | Zer0kiriN" />
<meta property="og:site_name" content="Zer0kiriN">
<meta property="og:locale" content="zh_CN">
<meta property="tag" content="Channel底层如何实现阻塞的 | Zer0kiriN" />


<script type="application/ld+json">
  {
"@context": "https://schema.org",
"@type": "BlogPosting",
"mainEntityOfPage": {
  "@type": "WebPage",
  "@id": "http://blog.zerokirin.online/post/channel-di-ceng-ru-he-shi-xian-zu-sai-de/"
},
"headline": "Channel底层如何实现阻塞的 | Zer0kiriN",
"datePublished": "Tue Jun 29 2021 14:24:06 GMT+0800",
"dateModified": "Tue Jun 29 2021 14:24:06 GMT+0800",
"author": {
  "@type": "Person",
  "name": "破庙主任"
},
"publisher": {
  "@type": "Organization",
  "name": "破庙主任",
  "logo": {
    "@type": "ImageObject",
    "url": "http://blog.zerokirin.online/favicon.ico"
  }
},
"image": [
""
],
"description": "
每日一问系列（一）

我们都知道，channel在缓冲区满或者无缓冲的时候，发送数据会阻塞，缓冲区空或无缓冲的时候，接受也会阻塞
那么这个阻塞，是怎么实现的呢？
之前我们只是粗略的讲解了channel的实现的结构体，这次我们详细的看看发送..."
 }

</script>
<script type="application/ld+json">
  {
    "@context": "https://schema.org/", 
    "@type": "BreadcrumbList", 
    "itemListElement": [{
      "@type": "ListItem", 
      "position": 1, 
      "name": "Home",
      "item": "http://blog.zerokirin.online"  
    },{
      "@type": "ListItem", 
      "position": 2, 
      "name": "Channel底层如何实现阻塞的 | Zer0kiriN",
      "item": "http://blog.zerokirin.online/post/channel-di-ceng-ru-he-shi-xian-zu-sai-de/"  
    }]
  }
  </script>







<script async custom-element="amp-form" src="https://cdn.ampproject.org/v0/amp-form-0.1.js"></script>
<script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"></script>
<script async custom-element="amp-audio" src="https://cdn.ampproject.org/v0/amp-audio-0.1.js"></script>


<script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script>



<script async custom-element="amp-gist" src="https://cdn.ampproject.org/v0/amp-gist-0.1.js"></script>

<link rel="alternate" type="application/atom+xml" title="Channel底层如何实现阻塞的 | Zer0kiriN - Atom Feed" href="http://blog.zerokirin.online/atom.xml">



  



  


</head>

<body>
  <input type="checkbox" id="header-menu-button">
  <header id="commonTop">
  <div class="top-container">
    <div class="title-menus-area">
      <a class="blog-title" href="http://blog.zerokirin.online">Zer0kiriN</a>
      <label for="header-menu-button" class="top-menus">
        <nav class="menu-menu-1-container">
          <ul id="menu-menu-1" class="menu">
            
            
            <li>
              <a href="/" aria-current="page">首页</a></li>
            
            
            
            <li>
              <a href="/archives" aria-current="page">归档</a></li>
            
            
            
            <li>
              <a href="/post/about" aria-current="page">关于</a></li>
            
            
            
            <li>
              <a href="http://blog.zerokirin.online/post/every-day" aria-current="page">Every Day</a></li>
            
            
          </ul>
        </nav>
      </label>
    </div>
    
  </div>
</header>
  <main>
    <div class="main-container">

      <div class="article-info">
        
          <div class="flex-box meta-category">
            <a class="post-cate" href="http://blog.zerokirin.online/tag/OAbnOVw0j/">每日一问</a></div>
          
        <h2 class="article-title">
          <a href="http://blog.zerokirin.online/post/channel-di-ceng-ru-he-shi-xian-zu-sai-de/">Channel底层如何实现阻塞的</a>
        </h2>
        <div class="flex-box">
          <div class="flex-box post-meta-box">
            <a class="post-meta" href="http://blog.zerokirin.online"><span
                class="iconfont icon-mr-postmeta"></span>破庙主任</a>
            <span class="post-meta"><span class="iconfont icon-mr-postmeta"></span>2021 年 06	月 29日</span>
            


          </div>
        </div>
      </div>
      <div class="content">
        <blockquote>
<p>每日一问系列（一）</p>
</blockquote>
<p>我们都知道，channel在缓冲区满或者无缓冲的时候，发送数据会阻塞，缓冲区空或无缓冲的时候，接受也会阻塞</p>
<p>那么这个阻塞，是怎么实现的呢？</p>
<p>之前我们只是粗略的讲解了channel的实现的结构体，这次我们详细的看看发送和接受的源码</p>
<p>源码位于<code>go 1.15.4 src/runtime/chan.go</code></p>
<h2 id="读取的两种方式">读取的两种方式</h2>
<pre><code class="language-go">ch := make(chan int, 10)
a := &lt;-ch
b,ok := &lt;-ch
</code></pre>
<p>golang有两种读取channel 的方式，</p>
<pre><code class="language-go">// entry points for &lt;- c from compiled code
//go:nosplit
func chanrecv1(c *hchan, elem unsafe.Pointer) {
	chanrecv(c, elem, true)
}

//go:nosplit
func chanrecv2(c *hchan, elem unsafe.Pointer) (received bool) { //看这里多了个返回值，received
	_, received = chanrecv(c, elem, true)
	return
}
</code></pre>
<p>这两个函数也就是读取的两个方法，第二个带有一个名为received的返回值</p>
<p>他们同时都调用了<code>chanrecv</code>函数，所以重点就在这个函数中</p>
<h2 id="读取函数">读取函数</h2>
<p>函数原型</p>
<pre><code class="language-go">// chanrecv receives on channel c and writes the received data to ep.
// ep may be nil, in which case received data is ignored.
// If block == false and no elements are available, returns (false, false).
***重点在这，如果block是false，且无法获取到数据，则直接返回(false,false)
***这个的另一个意思就是，即便缓冲区buf为空，也不会阻塞，而是直接返回，那么这个的使用场景是？
// Otherwise, if c is closed, zeros *ep and returns (true, false).
// Otherwise, fills in *ep with an element and returns (true, true).
// A non-nil ep must point to the heap or the caller's stack.
func chanrecv(c *hchan, ep unsafe.Pointer, block bool) (selected, received bool)
</code></pre>
<p>上面调用chanrecv的函数里面都是写死了block为true，那么什么时候是false呢？</p>
<pre><code class="language-go">// compiler implements
//
//	select {
//	case v = &lt;-c:
//		... foo
//	default:
//		... bar
//	}
//
// as
//
//	if selectnbrecv(&amp;v, c) {
//		... foo
//	} else {
//		... bar
//	}
//
func selectnbrecv(elem unsafe.Pointer, c *hchan) (selected bool) {
	selected, _ = chanrecv(c, elem, false)
	return
}

// compiler implements
//
//	select {
//	case v, ok = &lt;-c:
//		... foo
//	default:
//		... bar
//	}
//
// as
//
//	if c != nil &amp;&amp; selectnbrecv2(&amp;v, &amp;ok, c) {
//		... foo
//	} else {
//		... bar
//	}
//
func selectnbrecv2(elem unsafe.Pointer, received *bool, c *hchan) (selected bool) {
	// TODO(khr): just return 2 values from this function, now that it is in Go.
	selected, *received = chanrecv(c, elem, false)
	return
}
</code></pre>
<p>select的用法就是，哪个可以取到数据就执行哪个case，而如果无法读取到则不会执行，所以肯定不能是阻塞的，所以两个用法的block的都是false</p>
<p>chanrecv的返回值名字也很直白，selected和received</p>
<p>selected只在执行select语句的时候判断case是否可以执行，至于数据是否获取到，则要看第二个参数received</p>
<p>那么我们详细来看chanrecv的内容吧，过程中我删掉了部分race检测的代码以及原有的英文注释</p>
<pre><code class="language-go">//原子操作检测是否能读取或者缓冲是否为空
func empty(c *hchan) bool {
	// c.dataqsiz is immutable.
	if c.dataqsiz == 0 { //无缓冲，检测发送队列是否是nil
		return atomic.Loadp(unsafe.Pointer(&amp;c.sendq.first)) == nil
	}
    //有缓冲，检测当前数量有多少
	return atomic.Loaduint(&amp;c.qcount) == 0
}

func chanrecv(c *hchan, ep unsafe.Pointer, block bool) (selected, received bool) {
    //如果是nil
	if c == nil {
        //在select语句中block是false，所以会在这直接返回(false,false)，也就是说select永远不会进入一个对nil的chan操作的步骤
        if !block { 
			return
		}
        //阻塞了，所以读取nil并不会直接报错
		gopark(nil, nil, waitReasonChanReceiveNilChan, traceEvGoStop, 2)
		throw(&quot;unreachable&quot;)
	}

	// chan中是空的，没有办法直接获取值，且在select中，无需等待取值
	if !block &amp;&amp; empty(c) {
		//这里官方用了很长一段来描述为什么会这么写，大意是说
        //在竞争检测关闭时，可能会有多个goroutine对channel进行操作
        //比如说，一开始是，没有close的，非空的
        //后来被关闭了，然后把数据排空了
        //这时候由于检测语句的不合理安排以及并发访问
        //很有可能会得出一个，没有close的，空了的结果
        //所以对empty和closed都是原子操作去检测
        
		if atomic.Load(&amp;c.closed) == 0 { //未关闭
			//由于channel不能关了再开，所以如果检测到未关闭
            //则证明在一开始就是未关闭的
            //返回false，false
            //select不会继续下去，因为他还有收到值的可能性
			return
		}
		
        //执行到这一定是closed的了，再检测一次empty是因为
        //有可能在上面判断closed之前，有了新的数据，那么可能会是closed和非空
		if empty(c) {
			//确定是空，若接受体不为空，也就是不用_抛弃，则直接置为0值
			if ep != nil {
				typedmemclr(c.elemtype, ep)
			}
            //selected，可以执行这条路，但是v,ok=&lt;-ch的ok是false
			return true, false
		}
	}

    //后文初始化sudog的条件（暂时看不懂干嘛的，下次研究）
	var t0 int64
	if blockprofilerate &gt; 0 {
		t0 = cputicks()
	}

    //加锁
	lock(&amp;c.lock)

    //closed，且 缓冲buf 是空的
    //无论有无缓冲区，都是这个流程
	if c.closed != 0 &amp;&amp; c.qcount == 0 {
		unlock(&amp;c.lock)
		if ep != nil { //清空接收者
			typedmemclr(c.elemtype, ep)
		}
		return true, false
	}

    //如果发送队列不为空的话执行，注意
    //也就是要么无缓冲，要么缓冲buf满了，两种情况处理方法不一样，recv函数待会再讲
	if sg := c.sendq.dequeue(); sg != nil {
		recv(c, sg, ep, func() { unlock(&amp;c.lock) }, 3)
		return true, true
	}

    //数据个数大于0，那肯定是有缓冲类型的
	if c.qcount &gt; 0 {
        //通过这个chanbuf，获取到数据地址，存到qp中
		qp := chanbuf(c, c.recvx)
        //把qp移动到ep中
		if ep != nil {
			typedmemmove(c.elemtype, ep, qp)
		}
        //原来的数据置空
        //还有一点就是，如果上一个ep是nil，也就是用_忽略了的话，这一步也会把数据清掉
		typedmemclr(c.elemtype, qp)
        //循环链表，所以下标正常增长
		c.recvx++
        //涨到最大值后变为0，循环嘛
		if c.recvx == c.dataqsiz {
			c.recvx = 0
		}
        //取数据了，所以肯定要减小
		c.qcount--
		unlock(&amp;c.lock)
		return true, true
	}

    /*	前面我们已经排除了
    *	closed的，有发送队列的（缓冲类型溢出了，无缓冲类型有被阻塞的发送），缓冲区有值的
    *	剩下的就是，未closed的，缓冲区没数据且发送队列空的
    *	人话就是，轮到阻塞等待有缘人发送数据了
    */
    
    //select中没必要阻塞，直接就略过了
	if !block {
		unlock(&amp;c.lock)
		return false, false
	}

	//从这里开始就是阻塞的流程
    
    //获取当前运行的g的指针
	gp := getg()
    //获取一个sudog结构体
	mysg := acquireSudog()
	mysg.releasetime = 0
	if t0 != 0 {
		mysg.releasetime = -1
	}
	// No stack splits between assigning elem and enqueuing mysg
	// on gp.waiting where copystack can find it.
	mysg.elem = ep
	mysg.waitlink = nil
    //当前g正在等待的sudog
	gp.waiting = mysg
    //对应的g
	mysg.g = gp
    //是否在select语句中
	mysg.isSelect = false
    //标识是哪个chan
	mysg.c = c
    //唤醒时传递的参数，一般都是空
	gp.param = nil
    //将这个sudog放到接收队列中，等待唤醒
	c.recvq.enqueue(mysg)
	// Signal to anyone trying to shrink our stack that we're about
	// to park on a channel. The window between when this G's status
	// changes and when we set gp.activeStackChans is not safe for
	// stack shrinking.
    //这里设置个标志位，通知任何想要缩小栈空间情况，告诉他们这个g现在在等待channel的唤醒
    //这里会有线程安全问题，所以用atomic操作
	atomic.Store8(&amp;gp.parkingOnChan, 1)
    //暂停当前g，也就是实质上的阻塞，函数原型放在最后
	gopark(chanparkcommit, unsafe.Pointer(&amp;c.lock), waitReasonChanReceive, traceEvGoBlockRecv, 2)

	// someone woke us up
    //唤醒，检查下有没有呗错误唤醒
	if mysg != gp.waiting {
		throw(&quot;G waiting list is corrupted&quot;)
	}
    //等待的置空
	gp.waiting = nil
	gp.activeStackChans = false
	if mysg.releasetime &gt; 0 {
		blockevent(mysg.releasetime-t0, 2)
	}
	closed := gp.param == nil
	gp.param = nil
	mysg.c = nil
    //释放sudog
	releaseSudog(mysg)
	return true, !closed
}

// Puts the current goroutine into a waiting state and calls unlockf.
// If unlockf returns false, the goroutine is resumed.
// unlockf must not access this G's stack, as it may be moved between
// the call to gopark and the call to unlockf.
// Reason explains why the goroutine has been parked.
// It is displayed in stack traces and heap dumps.
// Reasons should be unique and descriptive.
// Do not re-use reasons, add new ones.
func gopark(unlockf func(*g, unsafe.Pointer) bool, lock unsafe.Pointer, reason waitReason, traceEv byte, traceskip int) 
</code></pre>
<p>再来让我们看看上面说的recv函数，上面的调用方式是这样的</p>
<p><code>recv(c, sg, ep, func() { unlock(&amp;c.lock) }, 3)</code></p>
<pre><code class="language-go">// recv processes a receive operation on a full channel c.
// There are 2 parts:
// 1) The value sent by the sender sg is put into the channel
//    and the sender is woken up to go on its merry way.
// 2) The value received by the receiver (the current G) is
//    written to ep.
// For synchronous channels, both values are the same.
// For asynchronous channels, the receiver gets its data from
// the channel buffer and the sender's data is put in the
// channel buffer.
// Channel c must be full and locked. recv unlocks c with unlockf.
// sg must already be dequeued from c.
// A non-nil ep must point to the heap or the caller's stack.

//上面注释写的很清楚，两个情况，一个是缓冲区满了，一个是没有缓冲区的
//总归都是sg不为空，也就是发送队列有人在等着发送数据
func recv(c *hchan, sg *sudog, ep unsafe.Pointer, unlockf func(), skip int) {
    //缓冲区0，也就是无缓冲
   if c.dataqsiz == 0 {
      if ep != nil {
         // copy data from sender
          //直接从发送者的sg中提取内容
         recvDirect(c.elemtype, sg, ep)
      }
   } else {
      // Queue is full. Take the item at the
      // head of the queue. Make the sender enqueue
      // its item at the tail of the queue. Since the
      // queue is full, those are both the same slot.
      //缓冲区满了
      //计算出当前应该提取的内容的位置
      qp := chanbuf(c, c.recvx)
      // copy data from queue to receiver
      //这里校验ep是因为有可能有 &lt;-ch 直接取值的情况存在
      if ep != nil {
          //将数据从刚刚计算好的位置拿出来
         typedmemmove(c.elemtype, ep, qp)
      }
      // copy data from sender to queue
      //把发送队列的东西复制到刚刚拿走了的位置
      typedmemmove(c.elemtype, qp, sg.elem)
      //下标加一，满了就置0
      c.recvx++
      if c.recvx == c.dataqsiz {
         c.recvx = 0
      }
      //设置一下已经发送的位置到哪了
      //也就是新数据该往哪放了
      c.sendx = c.recvx // c.sendx = (c.sendx+1) % c.dataqsiz
   }
   //发送完了就卸磨杀驴，该请的要清了
   sg.elem = nil
   //把发送的g的信息保存一下
   gp := sg.g
    //解锁函数，一般来说都是unlock(&amp;c.lock)
   unlockf()
   gp.param = unsafe.Pointer(sg)
   if sg.releasetime != 0 {
      sg.releasetime = cputicks()
   }
   //唤醒这个发送者，因为他的数据已经发送完成了，就没必要阻塞了
   goready(gp, skip+1)
}
</code></pre>
<h2 id="发送过程">发送过程</h2>
<p>和接受过程几乎一样，快速的看一下</p>
<pre><code class="language-go">/*
 * generic single channel send/recv
 * If block is not nil,
 * then the protocol will not
 * sleep but return if it could
 * not complete.
 *
 * sleep can wake up with g.param == nil
 * when a channel involved in the sleep has
 * been closed.  it is easiest to loop and re-run
 * the operation; we'll see that it's now closed.
 */
func chansend(c *hchan, ep unsafe.Pointer, block bool, callerpc uintptr) bool {
	if c == nil {
		if !block {
			return false
		}
		gopark(nil, nil, waitReasonChanSendNilChan, traceEvGoStop, 2)
		throw(&quot;unreachable&quot;)
	}

	// Fast path: check for failed non-blocking operation without acquiring the lock.
	//
	// After observing that the channel is not closed, we observe that the channel is
	// not ready for sending. Each of these observations is a single word-sized read
	// (first c.closed and second full()).
	// Because a closed channel cannot transition from 'ready for sending' to
	// 'not ready for sending', even if the channel is closed between the two observations,
	// they imply a moment between the two when the channel was both not yet closed
	// and not ready for sending. We behave as if we observed the channel at that moment,
	// and report that the send cannot proceed.
	//
	// It is okay if the reads are reordered here: if we observe that the channel is not
	// ready for sending and then observe that it is not closed, that implies that the
	// channel wasn't closed during the first observation. However, nothing here
	// guarantees forward progress. We rely on the side effects of lock release in
	// chanrecv() and closechan() to update this thread's view of c.closed and full().
    
    //上面一大串的注释就是告诉你，如何在不获取锁的情况下判断是否准备好发送数据了，先判断close和和先判断full(c)都是正确的
    
	if !block &amp;&amp; c.closed == 0 &amp;&amp; full(c) {
		return false
	}

	var t0 int64
	if blockprofilerate &gt; 0 {
		t0 = cputicks()
	}

	lock(&amp;c.lock)
	
    //已经关闭了，所以要panic，不能继续发送了
	if c.closed != 0 {
		unlock(&amp;c.lock)
		panic(plainError(&quot;send on closed channel&quot;))
	}

    //接收队列有东西，要么是缓冲区满了，要么是没有缓冲区
	if sg := c.recvq.dequeue(); sg != nil {
		// Found a waiting receiver. We pass the value we want to send
		// directly to the receiver, bypassing the channel buffer (if any).
        //下文详细讲下这个函数
		send(c, sg, ep, func() { unlock(&amp;c.lock) }, 3)
		return true
	}

    //缓冲区还没满，这里dataqsiz至少大于0，所以是有缓冲的
	if c.qcount &lt; c.dataqsiz {
		// Space is available in the channel buffer. Enqueue the element to send.
        //确定好应该存放的地址
		qp := chanbuf(c, c.sendx)
		typedmemmove(c.elemtype, qp, ep)
		c.sendx++
		if c.sendx == c.dataqsiz {
			c.sendx = 0
		}
		c.qcount++
		unlock(&amp;c.lock)
		return true
	}

    //没有能放的位置了，只能阻塞了
    //select中，非阻塞的直接返回了
	if !block {
		unlock(&amp;c.lock)
		return false
	}

	// Block on the channel. Some receiver will complete our operation for us.
	gp := getg()
	mysg := acquireSudog()
	mysg.releasetime = 0
	if t0 != 0 {
		mysg.releasetime = -1
	}
	// No stack splits between assigning elem and enqueuing mysg
	// on gp.waiting where copystack can find it.
	mysg.elem = ep
	mysg.waitlink = nil
	mysg.g = gp
	mysg.isSelect = false
	mysg.c = c
	gp.waiting = mysg
	gp.param = nil
    //把自己放到发送队列中
	c.sendq.enqueue(mysg)
	// Signal to anyone trying to shrink our stack that we're about
	// to park on a channel. The window between when this G's status
	// changes and when we set gp.activeStackChans is not safe for
	// stack shrinking.
	atomic.Store8(&amp;gp.parkingOnChan, 1)
    //阻塞住了
	gopark(chanparkcommit, unsafe.Pointer(&amp;c.lock), waitReasonChanSend, traceEvGoBlockSend, 2)
	// Ensure the value being sent is kept alive until the
	// receiver copies it out. The sudog has a pointer to the
	// stack object, but sudogs aren't considered as roots of the
	// stack tracer.
    
    //这里和接受的方法不一样的是，多了个keepalive
    //原因是，在接受方法中，ep是一个外部传进来的，数据的目的地址，那么ep在外部一定是被使用的，所以ep一定不会在阻塞的时候被gc回收掉，如果没有使用，那回收了就回收了，问题不大
    //但是，在这里ep是一个数据源地址，很有可能在发送以后就不存在了，那么阻塞的过程中就很有可能被回收掉，所以要加入一个保活的函数，策略就是，我后面还会用到这个变量，那么gc就不会扫描这个，这样只有被唤醒后，keepalive才会调用，然后ep数据已经发送出去了，回收就无所谓了
	KeepAlive(ep)

	// someone woke us up.
    //收尾工作没什么好讲的了
	if mysg != gp.waiting {
		throw(&quot;G waiting list is corrupted&quot;)
	}
	gp.waiting = nil
	gp.activeStackChans = false
	if gp.param == nil {
		if c.closed == 0 {
			throw(&quot;chansend: spurious wakeup&quot;)
		}
		panic(plainError(&quot;send on closed channel&quot;))
	}
	gp.param = nil
	if mysg.releasetime &gt; 0 {
		blockevent(mysg.releasetime-t0, 2)
	}
	mysg.c = nil
	releaseSudog(mysg)
	return true
}
</code></pre>
<p>看看send函数</p>
<p><code>send(c, sg, ep, func() { unlock(&amp;c.lock) }, 3)</code></p>
<pre><code class="language-go">// send processes a send operation on an empty channel c.
// The value ep sent by the sender is copied to the receiver sg.
// The receiver is then woken up to go on its merry way.
// Channel c must be empty and locked.  send unlocks c with unlockf.
// sg must already be dequeued from c.
// ep must be non-nil and point to the heap or the caller's stack.
func send(c *hchan, sg *sudog, ep unsafe.Pointer, unlockf func(), skip int) {
	//前面一大串都是涉及到竞争检测的内容，本次暂时不分析
	if sg.elem != nil {
        //看名字就很清楚了，从sg复制到ep
		sendDirect(c.elemtype, sg, ep)
		sg.elem = nil
	}
    //找到那个等待的g
	gp := sg.g
    //解锁
	unlockf()
	gp.param = unsafe.Pointer(sg)
	if sg.releasetime != 0 {
		sg.releasetime = cputicks()
	}
    //唤醒
	goready(gp, skip+1)
}
</code></pre>
<h2 id="总结">总结</h2>
<p>主要有两个方面，一个是block参数，为了方便实现select语句，所以是非阻塞的操作，不能执行就不执行了</p>
<p>另一方面就是gopark和goready函数，通过这两个函数对g进行阻塞，其中发送任务还要用keepalive保活</p>
<p><s>不愧是每日一问，写了四天好家伙</s></p>

      </div>

      
      <nav class="post-nav">
        
        
        <div class="nav-next">
          <a class="post-nav-link-active" title="Mysql 并发控制详解（四）——并发一致性错误的解决方式" href="http://blog.zerokirin.online/post/mysql-bing-fa-kong-zhi-xiang-jie-si-bing-fa-yi-zhi-xing-cuo-wu-de-jie-jue-fang-shi/">下一篇文章</a>
          

        </div>
      </nav>
      

      
      <div class="social-share">
  <div class="social-share-box">
    <amp-social-share class="rounded" type="email" layout="responsive" width="20" height="20"></amp-social-share>
  </div>
  <div class="social-share-box">
    <amp-social-share class="rounded" type="linkedin" layout="responsive" width="20" height="20">
    </amp-social-share>
  </div>
  <div class="social-share-box">
    <amp-social-share class="rounded" type="pinterest" layout="responsive"
      data-param-media="https://amp.dev/static/samples/img/amp.jpg" width="20" height="20"></amp-social-share>
  </div>
  <div class="social-share-box">
    <amp-social-share class="rounded" type="tumblr" layout="responsive" width="20" height="20"></amp-social-share>
  </div>
  <div class="social-share-box">
    <amp-social-share class="rounded" type="twitter" layout="responsive" width="20" height="20">
    </amp-social-share>
  </div>
  <div class="social-share-box">
    <amp-social-share class="rounded" type="whatsapp" layout="responsive" width="20" height="20">
    </amp-social-share>
  </div>
  <div class="social-share-box">
    <amp-social-share class="rounded" type="line" layout="responsive" width="20" height="20"></amp-social-share>
  </div>
</div>
      
      

      <div class="post-tags">
        
        <a href="http://blog.zerokirin.online/tag/OAbnOVw0j/" rel="tag">每日一问</a>        
        
        <a href="http://blog.zerokirin.online/tag/FGxA9Oea-/" rel="tag">运行时</a>        
        
        <a href="http://blog.zerokirin.online/tag/OeNZRWzRL/" rel="tag">goroutine</a>        
        
        <a href="http://blog.zerokirin.online/tag/nRa6ExP4g/" rel="tag">channel</a>        
        
        <a href="http://blog.zerokirin.online/tag/-Ep2xEDPKR/" rel="tag">笔记</a>        
               
      </div>


        

    </div>

    <div class="sidebar">
  <aside id="profile-2" class="widget widget_profile">
    <div class="profile-box">
      <div class="profile-avatar">
        <amp-img src="http://blog.zerokirin.online/images/avatar.png?v=1625004844759" alt="avatar"
          layout="fill"></amp-img>
      </div>
      <div class="profile-content">
        <div class="amp-wp-681d4ff">
          记录
        </div>

      </div>
    </div>
  </aside>
  
    <aside id="search-10" class="widget widget_search">
      <form target="_top" role="search" method=get class="search-form" action="https://www.google.com/search">
        <input type=hidden name=domains value="http://blog.zerokirin.online">
        <input type=hidden name=sitesearch value="http://blog.zerokirin.online">
        <input name="hl" value="zh-CN" type="hidden">
        <input required type="text" class="search-field" placeholder="搜索…" name="q">
        <button type="submit"
          class="search-submit"></button>
      </form>
    </aside>
    
    
      <aside id="recent-posts-2" class="widget widget_recent_entries">
        <h4 class="widget-title">近期文章</h4>
         <ul>
          
            
          <li>
           <a href="http://blog.zerokirin.online/post/channel-di-ceng-ru-he-shi-xian-zu-sai-de/" aria-current="page">Channel底层如何实现阻塞的</a>
          </li>
          
          
            
          <li>
           <a href="http://blog.zerokirin.online/post/mysql-bing-fa-kong-zhi-xiang-jie-si-bing-fa-yi-zhi-xing-cuo-wu-de-jie-jue-fang-shi/" aria-current="page">Mysql 并发控制详解（四）——并发一致性错误的解决方式</a>
          </li>
          
          
            
          <li>
           <a href="http://blog.zerokirin.online/post/mysql-mvcc-qian-xi/" aria-current="page">Mysql 并发控制详解（三）——MVCC</a>
          </li>
          
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
        </ul>
     </aside>
     
  
     
      <aside id="categories-2" class="widget widget_categories">
        <h4 class="widget-title">标签</h4>
        <ul>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/OAbnOVw0j/">
              每日一问
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/FGxA9Oea-/">
              运行时
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/OeNZRWzRL/">
              goroutine
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/nRa6ExP4g/">
              channel
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/-Ep2xEDPKR/">
              笔记
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/dc4Gx9uLG/">
              丢失修改
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/hI-pOeKlB2/">
              脏读
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/IFNiHkHN6k/">
              幻影读
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/1AHUHZuG3U/">
              不可重复读
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/5O7kpY_3x/">
              mvcc
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/QzNMfzp5RZ/">
              read view
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/ySqWPGbpzz/">
              快照读
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/o4wETGfLZ/">
              gap lock
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/ui3yFrilL_/">
              record lock
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/SFQS0SpY1O/">
              next-key lock
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/NL9exrDn0b/">
              Insert Intention Locks
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/EvUavYLoh4/">
              共享锁
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/QATRrTuM4h/">
              互斥锁
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/RifrudM78/">
              事务隔离等级
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/QlWdPOjLh/">
              select
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/M3QtfYt2dg/">
              mysql
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/HYOpPCKffB/">
              意向锁
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/wQhcZm0ye_/">
              update
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/3EExwt-CBi/">
              delete
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/k9o7itsYG6/">
              insert
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/3mkkIacOvl/">
              sql
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/aBLgVGYUdr/">
              char
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/RSdPrssEte/">
              varchar
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/zHUinlwqeK/">
              text
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/lkoJt7TKuY/">
              blob
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/VAofEbOV0f/">
              int
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/H8EsIEIFEm/">
              float
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/EnwgKJ1Hsn/">
              double
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/HSk83ub7Yf/">
              decimal
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/X87d8T0slJ/">
              timestamp
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/BdVYAYj4mu/">
              datetime
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/pvs_6vjYE9c/">
              mysql数据类型
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/1E5Eva_N1Pp/">
              sql语法
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/xeynZVmko/">
              go mod
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/3OGqShz15j/">
              go package
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/iBI9azZkgJ/">
              go stack
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/2n3c2auIY/">
              golang
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/a80OXa5tzp/">
              变量逃逸
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/qzFUt7Z9q/">
              应用层
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/sfbQ61MwD9/">
              HTTPS
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/3r2C_nCspS/">
              HTTP2.0
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/4qrh5mF4T5/">
              计算机网络
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/t3AfmBRjr/">
              传输层
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/00plriG5k/">
              网络层
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/EwjLvEpmk/">
              string
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/PM-CMPlRec/">
              rune
            </a>
            
              <li class="cat-item"><a href="http://blog.zerokirin.online/tag/i2Qk4pOuX/">
              map
            </a>
            
          </li>
    
        </ul>
      </aside>
      


  <aside id="linkcat-2" class="widget widget_links">
  <h4 class="widget-title">友链</h4>
  <ul class="xoxo blogroll">
    
      
    
  </ul>
</aside>


</div>
    <div class="scrolltop-wrap">
  <span tabindex="0" role="button" class="go-top" on="tap:commonTop.scrollTo(duration=500, position=top)">
    <span class="iconfont"></span>
  </span>
</div>
  </main>
  <footer>
  <div class="footer-container">
    <div class="footer-menus">
    </div>
    <div class="footer-copyright">
      
      
      <p>
        主题版本：1.3.0-beta.0；最新版本：<br><br><br><br>
        <a href="https://github.com/jiansing/gridea-theme-inlineamp/releases" rel="nofollow">
        <amp-img alt="InlineAMP release (latest by date)" src="https://img.shields.io/github/v/release/jiansing/gridea-theme-inlineamp" height="20" width="80"></amp-img></a>
      </p>
      
      

    </div>
  </div>
</footer>


  


</body>

</html>